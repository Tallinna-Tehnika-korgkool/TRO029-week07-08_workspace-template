name: Week 07-08 ROS2 Workspace Check

on:
  push:
    branches:
      - "**"
  pull_request:
    branches:
      - main

jobs:
  validate-ros2-workspace:
    runs-on: ubuntu-latest
    container:
      image: osrf/ros:humble-desktop
    
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v4

      - name: ğŸ”§ Setup ROS2 Environment
        run: |
          echo "Setting up ROS2 Humble environment..."
          . /opt/ros/humble/setup.bash
          echo "ROS_DISTRO=$ROS_DISTRO"
          echo "âœ… ROS2 environment ready"

      - name: ğŸ“‚ Validate Workspace Structure
        id: structure_check
        run: |
          . /opt/ros/humble/setup.bash
          
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸ“‚ SAMM 1: Kontrollin workspace struktuuri"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo ""
          
          ERRORS=0
          SUCCESS=0
          
          # Kontrolli workspace juurkausta
          if [ -d "ros2_ws" ]; then
            echo "âœ… Workspace 'ros2_ws' olemas"
            ((SUCCESS++))
          else
            echo "âŒ VIGA: Workspace 'ros2_ws' puudub"
            echo "   ğŸ’¡ Loo see: mkdir -p ros2_ws/src"
            ((ERRORS++))
          fi
          
          # Kontrolli src kausta
          if [ -d "ros2_ws/src" ]; then
            echo "âœ… Source kaust 'ros2_ws/src' olemas"
            ((SUCCESS++))
          else
            echo "âŒ VIGA: Source kaust puudub"
            echo "   ğŸ’¡ Loo see: mkdir -p ros2_ws/src"
            ((ERRORS++))
          fi
          
          echo ""
          echo "STRUCTURE_ERRORS=$ERRORS" >> $GITHUB_ENV
          echo "STRUCTURE_SUCCESS=$SUCCESS" >> $GITHUB_ENV
          
          if [ $ERRORS -gt 0 ]; then
            exit 1
          fi

      - name: ğŸ“¦ Validate Package
        id: package_check
        if: success() || failure()
        run: |
          . /opt/ros/humble/setup.bash
          
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸ“¦ SAMM 2: Kontrollin paketi olemasolu ja struktuuri"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo ""
          
          ERRORS=0
          SUCCESS=0
          WARNINGS=0
          
          PKG_NAME="week07_08_my_package"
          PKG_PATH="ros2_ws/src/$PKG_NAME"
          
          # Kontrolli paketi kausta
          if [ -d "$PKG_PATH" ]; then
            echo "âœ… Pakett '$PKG_NAME' olemas"
            ((SUCCESS++))
          else
            echo "âŒ VIGA: Pakett '$PKG_NAME' puudub"
            echo "   ğŸ“ Oodatud asukoht: $PKG_PATH"
            echo "   ğŸ’¡ Loo see: cd ros2_ws/src && ros2 pkg create --build-type ament_python --license Apache-2.0 --node-name my_node $PKG_NAME"
            ((ERRORS++))
            echo "PACKAGE_ERRORS=$ERRORS" >> $GITHUB_ENV
            exit 1
          fi
          
          # Kontrolli package.xml
          if [ -f "$PKG_PATH/package.xml" ]; then
            echo "âœ… Fail 'package.xml' olemas"
            ((SUCCESS++))
          else
            echo "âŒ VIGA: 'package.xml' puudub"
            ((ERRORS++))
          fi
          
          # Kontrolli setup.py
          if [ -f "$PKG_PATH/setup.py" ]; then
            echo "âœ… Fail 'setup.py' olemas"
            ((SUCCESS++))
          else
            echo "âŒ VIGA: 'setup.py' puudub"
            ((ERRORS++))
          fi
          
          # Kontrolli paketi kausta struktuuri
          if [ -d "$PKG_PATH/$PKG_NAME" ]; then
            echo "âœ… Python paketi kaust olemas: $PKG_NAME/$PKG_NAME"
            ((SUCCESS++))
          else
            echo "âŒ VIGA: Python paketi kaust puudub"
            ((ERRORS++))
          fi
          
          echo ""
          echo "PACKAGE_ERRORS=$ERRORS" >> $GITHUB_ENV
          echo "PACKAGE_SUCCESS=$SUCCESS" >> $GITHUB_ENV
          
          if [ $ERRORS -gt 0 ]; then
            exit 1
          fi

      - name: ğŸ“ Validate Package Metadata
        id: metadata_check
        if: success() || failure()
        run: |
          . /opt/ros/humble/setup.bash
          
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸ“ SAMM 3: Kontrollin metaandmeid (package.xml ja setup.py)"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo ""
          
          ERRORS=0
          SUCCESS=0
          WARNINGS=0
          
          PKG_NAME="week07_08_my_package"
          PKG_PATH="ros2_ws/src/$PKG_NAME"
          
          # ============================================
          # PACKAGE.XML KONTROLL
          # ============================================
          
          echo "ğŸ“‹ Kontrollin package.xml..."
          echo ""
          
          if [ ! -f "$PKG_PATH/package.xml" ]; then
            echo "âŒ VIGA: package.xml puudub - ei saa metaandmeid kontrollida"
            ((ERRORS++))
          else
            # Kontrolli description
            if grep -q "<description>.*TODO.*</description>" "$PKG_PATH/package.xml" || \
               grep -q "<description></description>" "$PKG_PATH/package.xml"; then
              echo "âŒ VIGA: package.xml description on tÃ¤itmata vÃµi sisaldab 'TODO'"
              echo "   ğŸ’¡ Muuda: <description>Minu ROS2 pakett nÃ¤dalaks 7-8</description>"
              ((ERRORS++))
            else
              DESC=$(grep -oP '(?<=<description>).*?(?=</description>)' "$PKG_PATH/package.xml" | head -n1)
              if [ -n "$DESC" ] && [ "$DESC" != " " ]; then
                echo "âœ… Description tÃ¤idetud: '$DESC'"
                ((SUCCESS++))
              else
                echo "âŒ VIGA: Description on tÃ¼hi"
                ((ERRORS++))
              fi
            fi
            
            # Kontrolli maintainer
            if grep -q 'maintainer email=".*TODO.*"' "$PKG_PATH/package.xml" || \
               grep -q 'maintainer email="">.*</maintainer>' "$PKG_PATH/package.xml"; then
              echo "âŒ VIGA: package.xml maintainer_email on tÃ¤itmata vÃµi sisaldab 'TODO'"
              echo "   ğŸ’¡ Muuda: <maintainer email=\"sinu.nimi@email.com\">Sinu Nimi</maintainer>"
              ((ERRORS++))
            else
              MAINT=$(grep -oP '(?<=<maintainer email=").*?(?=">)' "$PKG_PATH/package.xml" | head -n1)
              if [ -n "$MAINT" ] && [ "$MAINT" != " " ] && [[ "$MAINT" == *"@"* ]]; then
                echo "âœ… Maintainer email tÃ¤idetud: '$MAINT'"
                ((SUCCESS++))
              else
                echo "âŒ VIGA: Maintainer email on vale formaadis vÃµi tÃ¼hi"
                echo "   ğŸ’¡ Peab sisaldama @-mÃ¤rki"
                ((ERRORS++))
              fi
            fi
            
            # Kontrolli maintainer nime
            MAINT_NAME=$(grep -oP '(?<=>).*?(?=</maintainer>)' "$PKG_PATH/package.xml" | head -n1)
            if [ -n "$MAINT_NAME" ] && [ "$MAINT_NAME" != " " ] && [ "$MAINT_NAME" != "TODO" ]; then
              echo "âœ… Maintainer nimi tÃ¤idetud: '$MAINT_NAME'"
              ((SUCCESS++))
            else
              echo "âŒ VIGA: Maintainer nimi on tÃ¤itmata vÃµi 'TODO'"
              ((ERRORS++))
            fi
            
            # Kontrolli license
            if grep -q "<license>Apache-2.0</license>" "$PKG_PATH/package.xml"; then
              echo "âœ… License on korrektne: Apache-2.0"
              ((SUCCESS++))
            else
              echo "âš ï¸ HOIATUS: License ei ole Apache-2.0 (soovitatud)"
              ((WARNINGS++))
            fi
          fi
          
          echo ""
          
          # ============================================
          # SETUP.PY KONTROLL
          # ============================================
          
          echo "ğŸ“‹ Kontrollin setup.py..."
          echo ""
          
          if [ ! -f "$PKG_PATH/setup.py" ]; then
            echo "âŒ VIGA: setup.py puudub - ei saa metaandmeid kontrollida"
            ((ERRORS++))
          else
            # Kontrolli description
            if grep -q "description='TODO:" "$PKG_PATH/setup.py" || \
               grep -q "description=''" "$PKG_PATH/setup.py"; then
              echo "âŒ VIGA: setup.py description on tÃ¤itmata vÃµi sisaldab 'TODO'"
              echo "   ğŸ’¡ Muuda: description='Minu ROS2 pakett nÃ¤dalaks 7-8',"
              ((ERRORS++))
            else
              DESC=$(grep -oP "description='\K[^']+" "$PKG_PATH/setup.py" | head -n1)
              if [ -n "$DESC" ] && [ "$DESC" != " " ]; then
                echo "âœ… Description tÃ¤idetud: '$DESC'"
                ((SUCCESS++))
              else
                echo "âŒ VIGA: Description on tÃ¼hi"
                ((ERRORS++))
              fi
            fi
            
            # Kontrolli maintainer
            if grep -q "maintainer='TODO" "$PKG_PATH/setup.py" || \
               grep -q "maintainer=''" "$PKG_PATH/setup.py"; then
              echo "âŒ VIGA: setup.py maintainer on tÃ¤itmata"
              ((ERRORS++))
            else
              MAINT=$(grep -oP "maintainer='\K[^']+" "$PKG_PATH/setup.py" | head -n1)
              if [ -n "$MAINT" ] && [ "$MAINT" != " " ]; then
                echo "âœ… Maintainer tÃ¤idetud: '$MAINT'"
                ((SUCCESS++))
              else
                echo "âŒ VIGA: Maintainer on tÃ¼hi"
                ((ERRORS++))
              fi
            fi
            
            # Kontrolli maintainer_email
            if grep -q "maintainer_email='TODO" "$PKG_PATH/setup.py" || \
               grep -q "maintainer_email=''" "$PKG_PATH/setup.py"; then
              echo "âŒ VIGA: setup.py maintainer_email on tÃ¤itmata"
              ((ERRORS++))
            else
              EMAIL=$(grep -oP "maintainer_email='\K[^']+" "$PKG_PATH/setup.py" | head -n1)
              if [ -n "$EMAIL" ] && [ "$EMAIL" != " " ] && [[ "$EMAIL" == *"@"* ]]; then
                echo "âœ… Maintainer email tÃ¤idetud: '$EMAIL'"
                ((SUCCESS++))
              else
                echo "âŒ VIGA: Maintainer email on vale formaadis"
                ((ERRORS++))
              fi
            fi
            
            # Kontrolli license
            if grep -q "license='Apache-2.0'" "$PKG_PATH/setup.py"; then
              echo "âœ… License on korrektne: Apache-2.0"
              ((SUCCESS++))
            else
              echo "âš ï¸ HOIATUS: License ei ole Apache-2.0 (soovitatud)"
              ((WARNINGS++))
            fi
          fi
          
          echo ""
          echo "METADATA_ERRORS=$ERRORS" >> $GITHUB_ENV
          echo "METADATA_SUCCESS=$SUCCESS" >> $GITHUB_ENV
          echo "METADATA_WARNINGS=$WARNINGS" >> $GITHUB_ENV
          
          if [ $ERRORS -gt 0 ]; then
            exit 1
          fi

      - name: ğŸ”¨ Build Workspace
        id: build_check
        if: success() || failure()
        run: |
          . /opt/ros/humble/setup.bash
          
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸ”¨ SAMM 4: Kompileerin workspace'i"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo ""
          
          cd ros2_ws
          
          echo "ğŸ“‹ KÃ¤ivitan: colcon build --packages-select week07_08_my_package"
          echo ""
          
          # Proovi kompileerida
          if colcon build --packages-select week07_08_my_package 2>&1 | tee build.log; then
            echo ""
            echo "âœ… Build Ãµnnestus!"
            echo "BUILD_SUCCESS=true" >> $GITHUB_ENV
            
            # Kontrolli kas install kaust tekkis
            if [ -d "install" ]; then
              echo "âœ… Install kaust loodud"
            fi
            
          else
            echo ""
            echo "âŒ Build ebaÃµnnestus!"
            echo ""
            echo "ğŸ“‹ VIIMASED VEAREAD:"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            tail -n 30 build.log
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            echo ""
            echo "ğŸ’¡ SOOVITUSED:"
            echo "   1. Kontrolli package.xml ja setup.py sÃ¼ntaksit"
            echo "   2. Veendu, et kÃµik nÃµutud failid on olemas"
            echo "   3. Vaata tÃ¤ielik build log Ã¼lalpool"
            echo ""
            echo "BUILD_SUCCESS=false" >> $GITHUB_ENV
            exit 1
          fi

      - name: ğŸš€ Test Node Execution
        id: node_check
        if: env.BUILD_SUCCESS == 'true'
        run: |
          . /opt/ros/humble/setup.bash
          cd ros2_ws
          . install/setup.bash
          
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸš€ SAMM 5: Testin node'i kÃ¤ivitamist"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo ""
          
          PKG_NAME="week07_08_my_package"
          NODE_NAME="my_node"
          
          echo "ğŸ“‹ KÃ¤ivitan: ros2 run $PKG_NAME $NODE_NAME"
          echo "   (Annan node'ile 3 sekundit kÃ¤ivitamiseks)"
          echo ""
          
          # KÃ¤ivita node taustal ja salvesta vÃ¤ljund
          timeout 3s ros2 run $PKG_NAME $NODE_NAME > node_output.txt 2>&1 &
          NODE_PID=$!
          
          sleep 1
          
          # Kontrolli kas node kÃ¤ivitus
          if ps -p $NODE_PID > /dev/null 2>&1; then
            echo "âœ… Node kÃ¤ivitus edukalt!"
            
            # Oota veidi, et node saaks midagi vÃ¤ljastada
            sleep 1
            
            # LÃµpeta node
            kill $NODE_PID 2>/dev/null || true
            wait $NODE_PID 2>/dev/null || true
            
            # Kontrolli vÃ¤ljundit
            if [ -f "node_output.txt" ] && [ -s "node_output.txt" ]; then
              echo ""
              echo "ğŸ“‹ Node'i vÃ¤ljund:"
              echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
              cat node_output.txt
              echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
              
              # Kontrolli kas sisaldab oodatud teksti
              if grep -qi "Hi from" node_output.txt; then
                echo "âœ… Node vÃ¤ljund sisaldab oodatud teksti 'Hi from...'"
              else
                echo "âš ï¸ HOIATUS: Node'i vÃ¤ljund ei sisalda oodatud teksti 'Hi from...'"
              fi
            else
              echo "âš ï¸ HOIATUS: Node ei tootnud vÃ¤ljundit (see on OK, kui node on vaikne)"
            fi
            
            echo "NODE_SUCCESS=true" >> $GITHUB_ENV
          else
            echo "âŒ Node ei kÃ¤ivitunud korralikult"
            echo ""
            if [ -f "node_output.txt" ]; then
              echo "ğŸ“‹ Vea vÃ¤ljund:"
              cat node_output.txt
            fi
            echo ""
            echo "ğŸ’¡ SOOVITUSED:"
            echo "   1. Kontrolli, kas my_node on setup.py entry_points'is mÃ¤Ã¤ratud"
            echo "   2. Veendu, et node fail eksisteerib kaustas $PKG_NAME/"
            echo "   3. Proovi kÃ¤ivitada lokaalselt: ros2 run $PKG_NAME $NODE_NAME"
            echo ""
            echo "NODE_SUCCESS=false" >> $GITHUB_ENV
            exit 1
          fi

      - name: ğŸ“Š Generate Final Report
        if: always()
        run: |
          echo ""
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸ“Š LÃ•PLIK KOKKUVÃ•TE - Week 07-08"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo ""
          
          # Structure
          STRUCT_SUCCESS=${STRUCTURE_SUCCESS:-0}
          STRUCT_ERRORS=${STRUCTURE_ERRORS:-0}
          if [ "$STRUCT_ERRORS" -eq 0 ] && [ "$STRUCT_SUCCESS" -gt 0 ]; then
            echo "âœ… Workspace struktuur: OK ($STRUCT_SUCCESS kontrolli)"
          else
            echo "âŒ Workspace struktuur: VIGA ($STRUCT_ERRORS viga)"
          fi
          
          # Package
          PKG_SUCCESS=${PACKAGE_SUCCESS:-0}
          PKG_ERRORS=${PACKAGE_ERRORS:-0}
          if [ "$PKG_ERRORS" -eq 0 ] && [ "$PKG_SUCCESS" -gt 0 ]; then
            echo "âœ… Paketi struktuur: OK ($PKG_SUCCESS kontrolli)"
          else
            echo "âŒ Paketi struktuur: VIGA ($PKG_ERRORS viga)"
          fi
          
          # Metadata
          META_SUCCESS=${METADATA_SUCCESS:-0}
          META_ERRORS=${METADATA_ERRORS:-0}
          META_WARNINGS=${METADATA_WARNINGS:-0}
          if [ "$META_ERRORS" -eq 0 ] && [ "$META_SUCCESS" -gt 0 ]; then
            echo "âœ… Metaandmed: OK ($META_SUCCESS kontrolli, $META_WARNINGS hoiatust)"
          else
            echo "âŒ Metaandmed: VIGA ($META_ERRORS viga)"
          fi
          
          # Build
          if [ "${BUILD_SUCCESS:-false}" == "true" ]; then
            echo "âœ… Kompileerimine: OK"
          else
            echo "âŒ Kompileerimine: EBAÃ•NNESTUS"
          fi
          
          # Node
          if [ "${NODE_SUCCESS:-false}" == "true" ]; then
            echo "âœ… Node kÃ¤ivitamine: OK"
          else
            echo "âŒ Node kÃ¤ivitamine: EBAÃ•NNESTUS"
          fi
          
          echo ""
          
          # Overall result
          TOTAL_ERRORS=$((STRUCT_ERRORS + PKG_ERRORS + META_ERRORS))
          
          if [ "$TOTAL_ERRORS" -eq 0 ] && \
             [ "${BUILD_SUCCESS:-false}" == "true" ] && \
             [ "${NODE_SUCCESS:-false}" == "true" ]; then
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            echo "ğŸ‰ PALJU Ã•NNE! KÃµik testid lÃ¤bitud!"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            echo ""
            echo "âœ“ Workspace struktuur on korrektne"
            echo "âœ“ Pakett on loodud ja metaandmed tÃ¤idetud"
            echo "âœ“ Kood kompileerub"
            echo "âœ“ Node kÃ¤ivitub korralikult"
            echo ""
            echo "ğŸ“š JÃ¤rgmine samm: Liigu edasi Week 09-10 (Publisher/Subscriber)"
            echo ""
          else
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            echo "âŒ ÃœLESANNE VAJAB PARANDAMIST"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            echo ""
            echo "ğŸ“‹ Vaata Ã¼lalpool samme ja paranda punasega (âŒ) mÃ¤rgitud vead"
            echo ""
          fi

      - name: ğŸ“ Create GitHub Summary
        if: always()
        run: |
          cat >> $GITHUB_STEP_SUMMARY << 'EOF'
          ## ğŸ“Š Week 07-08: ROS2 Workspace - Tulemused
          
          ### Kontrollide Ã¼levaade:
          
          | Samm | Kirjeldus | Tulemus |
          |------|-----------|---------|
          | ğŸ“‚ Struktuur | ros2_ws ja src kaustad | ${{ env.STRUCTURE_ERRORS == '0' && 'âœ… OK' || 'âŒ Viga' }} |
          | ğŸ“¦ Pakett | week07_08_my_package loomine | ${{ env.PACKAGE_ERRORS == '0' && 'âœ… OK' || 'âŒ Viga' }} |
          | ğŸ“ Metaandmed | package.xml ja setup.py | ${{ env.METADATA_ERRORS == '0' && 'âœ… OK' || 'âŒ Viga' }} |
          | ğŸ”¨ Build | colcon build | ${{ env.BUILD_SUCCESS == 'true' && 'âœ… OK' || 'âŒ EbaÃµnnestus' }} |
          | ğŸš€ Node | my_node kÃ¤ivitamine | ${{ env.NODE_SUCCESS == 'true' && 'âœ… OK' || 'âŒ EbaÃµnnestus' }} |
          
          ---
          
          ### ğŸ“‹ NÃµuded Ã¼lesandes:
          
          **Ãœlesanne A:** Loo pakett
          - âœ… `ros2 pkg create --build-type ament_python`
          - âœ… Paketi nimi: `week07_08_my_package`
          - âœ… Node nimi: `my_node`
          
          **Ãœlesanne B:** Metaandmed
          - âœ… `package.xml`: description, maintainer, email
          - âœ… `setup.py`: samad vÃ¤ljad tÃ¤idetud
          - âœ… License: Apache-2.0
          
          **Ãœlesanne C:** Build ja kÃ¤ivita
          - âœ… `colcon build` Ãµnnestub
          - âœ… Node kÃ¤ivitub: `ros2 run week07_08_my_package my_node`
          
          ---
          
          ### ğŸ”§ Kui test ebaÃµnnestus:
          
          1. **Vaata detailset vÃ¤ljundit** Ã¼lalpool (iga sammu logi)
          2. **Leia konkreetne viga** - iga samm nÃ¤itab tÃ¤pselt, mis valesti
          3. **Paranda lokaalses repos:**
             ```bash
             # Kontrolli struktuuri
             ls -la ros2_ws/src/week07_08_my_package/
             
             # Proovi buildi
             cd ros2_ws
             colcon build --packages-select week07_08_my_package
             
             # Testi node'i
             . install/setup.bash
             ros2 run week07_08_my_package my_node
             ```
          4. **Push uuesti:**
             ```bash
             git add .
             git commit -m "fix: parandused week 07-08 Ã¼lesandes"
             git push
             ```
          
          ---
          
          ### ğŸ’¡ Levinud vead:
          
          - âŒ **"package.xml puudub"** â†’ Paketi nimi on vale vÃµi kaust puudub
          - âŒ **"Build ebaÃµnnestus"** â†’ Kontrolli package.xml ja setup.py sÃ¼ntaksit
          - âŒ **"Node ei kÃ¤ivitu"** â†’ Kontrolli entry_points'i setup.py's
          - âŒ **"Metaandmed TODO"** â†’ TÃ¤ida kÃµik description/maintainer vÃ¤ljad
          
          ---
          
          ### ğŸ“š Abimaterjalid:
          
          - [Week 07-08 README](https://github.com/Tallinna-Tehnika-korgkool/TRO029---ROS2-sissejuhatus)
          - [ROS2 Package Creation](https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Creating-Your-First-ROS2-Package.html)
          - [Colcon Build](https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Colcon-Tutorial.html)
          
          EOF